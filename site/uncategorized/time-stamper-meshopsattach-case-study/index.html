<!DOCTYPE html>
<!-- BEGIN html --><html lang="en-US">

<!-- BEGIN head -->
<head>

	<!-- Meta Tags -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="generator" content="Hoarder 1.1.1">
<meta name="generator" content="ZillaFramework 1.0.2.5">

	<!-- Title -->
	<title>Time Stamper &#8211; Meshops.attach() Case Study | Dave Stewart IO</title>

	<!-- RSS & Pingbacks -->
	<link rel="alternate" type="application/rss+xml" title="Dave Stewart IO RSS Feed" href="/feed/">

	<link rel="dns-prefetch" href="//s.w.org">
<link rel="stylesheet" id="hoarder-style-css" href="/wordpress/wp-content/themes/davestewart/style.css?ver=1.1.1" type="text/css" media="all">
<link rel="stylesheet" id="jquery.lightbox.min.css-css" href="/wordpress/wp-content/plugins/wp-jquery-lightbox/styles/lightbox.min.css?ver=1.4.6" type="text/css" media="all">
<script type="text/javascript" src="/wordpress/wp-includes/js/jquery/jquery.js?ver=1.12.4"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/superfish.js?ver=1.4.8"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/supersubs.js?ver=0.2"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.flexslider-min.js?ver=2.0"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.jplayer.min.js?ver=2.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.imagesloaded.min.js?ver=2.0.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.isotope.min.js?ver=1.5.19"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.fitvids.js?ver=1.0"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/includes/js/twitter.js?ver=4.9.18"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/vendor/jquery/jquery.sticky.js?ver=2.0.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/vendor/jquery/jquery.cookie.js?ver=4.9.18"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/assets/js/zilla-media.js?ver=2.0.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/assets/js/scripts.js?ver=2.0.1"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/wordpress/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wordpress/wp-includes/wlwmanifest.xml">
<link rel="canonical" href="/uncategorized/time-stamper-meshopsattach-case-study/">



<style type="text/css">.wp-editor-container{
		border:1px solid #DDD;
		margin-bottom:10px;
	}</style>

<!-- END head -->
</head>

<!-- BEGIN body -->
<body class="post-template-default single single-post postid-188 single-format-standard no-js unknown post-time-stamper-meshopsattach-case-study zilla layout-2cr">

	    		<!-- BEGIN #header -->
		<div id="header">

		    <!-- BEGIN .header-inner -->
		    <div class="header-inner">

    			<!-- BEGIN #logo -->
    			<div id="logo">
    				<a href="/">Dave Stewart</a> <span>|</span> <a href="https://davestewart.co.uk/" title="Go to davestewart.co.uk">io</a>
    				<p id="tagline">Research » Tooling » Open Source</p>
    			<!-- END #logo -->
    			</div>


	        <!-- END .header-inner -->
	        </div>

		<!-- END #header-->
		</div>

		<!-- BEGIN .main-navigation -->
		<div class="main-navigation">

		        		<!-- BEGIN #primary-nav -->
    		<div id="primary-nav">
    		    <ul id="primary-menu" class="menu">
<li id="menu-item-373" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-373"><a href="/">Home</a></li>
<li id="menu-item-369" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-369"><a href="/category/frameworks/">Frameworks</a></li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-368"><a href="/category/tools/">Tools</a></li>
<li id="menu-item-887" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-887"><a href="/all/plugins/">Plugins</a></li>
<li id="menu-item-888" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-888"><a href="/all/extensions/">Extensions</a></li>
<li id="menu-item-1064" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1064"><a href="/category/setup/">Setup</a></li>
<li id="menu-item-977" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-977"><a href="/posts-by-category/">Everything</a></li>
<li id="menu-item-1006" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1006"><a href="/about/">About</a></li>
</ul>
    		    <!-- BEGIN #searchform-->
<form method="get" id="searchform" action="/">
	<fieldset>
		<input type="text" name="s" id="s">
	</fieldset>
<!-- END #searchform-->
</form>    		<!-- END #primary-nav -->
    		</div>

		<!-- END .main-navigation -->
		</div>

		<!-- BEGIN #content -->
		<div id="content" class="clearfix">




<!-- FILE davestewart/single.php -->

			<!-- BEGIN #primary .hfeed-->
			<div id="primary" class="hfeed">

								<!-- BEGIN .hentry -->
				<div class="post-188 post type-post status-publish format-standard hentry" id="post-188">

    				<!-- FILE davestewart/content.php -->
<div class="post-thumb">


</div>

    <h1 class="entry-title">Time Stamper &#8211; Meshops.attach() Case Study</h1>
	<div class="entry-meta-header">
			</div>



<!-- BEGIN .entry-content -->
<div class="entry-content">

	<h3>Overview</h3>
<p>In response to a post on CG Talk,  <a href="https://forums.cgsociety.org/showthread.php?p=5172805#post5172805">Optimization ideas needed</a>, a few other developers and I us pitched in to help out with ideas to solve a puzzling problem.</p>
<p>The issue was that a loop to attach 7500 objects was taking up to 8 minutes to complete. Where did the problem lie? Was it in the transformation code, the attachment code, or somewhere else?</p>
<p>Well as luck would have it, today&#039;s Bank Holiday has been totally washed out with rain, so I had nothing better to than to do some testing and find the cause, and in the process road test my recently-developed <a href="/development/maxscript/time-stamper/">TimeStamper</a> struct.</p>
<h3>Approach</h3>
<p>After turning undo and redraw off, as well as optimizing the transformation code within the script, which cut a 1000-object test scene&#039;s processing time in half, surprisingly the 7500-object scene was still taking around 8 minutes.</p>
<p>I suspected that the problem may well be in the fact that as mesh gets larger, perhaps it becomes computationally more expensive to add new meshes, seeing as the entire array of points and faces needs to be evaluated every time a new mesh is added. Cumulatively, this could really add up.</p>
<p>I though that perhaps the right approach would be to split the attaching up into phases, using a 2D loop, and I suspected that perhaps the square-root of the total attaches might yield the optimal performance, ie for 10000 attaches I&#039;d perform a 100 x 100 loop, creating 100 intermediate meshes, then attaching them all at the end.</p>
<h3> Results</h3>
<p>These are the results for various variations of 2D loops, limiting the amount of objects attached per loop. The results are impressive!</p>
<ul>
<li>For 1000 objects, the optimum loop combination was 31 loops of 32, a speed increase of <strong>12 </strong>times over a single loop</li>
<li>For 3000 objects, the optimum loop combination was 55 loops of 54, a speed increase of <strong>22 </strong>times over a single loop</li>
<li>For 5000 objects, the optimum loop combination was 50 loops of 100, a speed increase of <strong>28 </strong>times over a single loop</li>
<li>For 7500 objects, the optimum loop combination was 87 loops of 86, a speed increase of <strong>30 </strong>times over a single loop</li>
</ul>
<p>And yes, the square root approach was most successful 3 out of 4 times.</p>
<p>Here are the results in table format, with the optimum loop highlighted:</p>
<p><img src="/resources/maxscript/For%20Scripters/Time%20Stamper/img/time-stamper-table.gif"></p>
<h3>1D / 2D loop comparison</h3>
<p>Compared to the 1D loop, the 2D loop was <strong>30</strong> times faster on <strong>7500 </strong>attachments.</p>
<p>In minutes and seconds, that means a decrease from <strong>6 minutes and 29 seconds</strong> to just <strong>12 seconds</strong>!</p>
<p>In graph-form that looks like this:</p>
<p><img src="/resources/maxscript/For%20Scripters/Time%20Stamper/img/time-stamper-graph.gif"></p>
<h3>Conclusion</h3>
<p>It seems pretty safe to say that in this case, building up intermediate meshes and attaching at the end is the best way to go. It looks likely that adding to already-huge arrays carries with it an overhead that can have an extremely negative effect in a lengthy loop situation.</p>
<p>I&#039;ve no doubt that this approach most likely extends to other mesh / array / hash based computations as well, so splitting up large cumulatively-expensive calculations into smaller chunks could well be a great time-saver in other tasks as well.</p>
<p>So &#8211; a shame about the rain, but perhaps a bonus in disguise!</p>
<h3>Resources</h3>
<ul>
<li>View the <a href="/development/maxscript/time-stamper/">Time Stamper page</a>
</li>
<li>Download <a href="/resources/maxscript/For%20Scripters/Time%20Stamper/TimeStamper.ms">TimeStamper.ms</a>
</li>
<li>Download the <a href="/resources/maxscript/For%20Scripters/Time%20Stamper/TimeStamper-create-spheres.ms">test script</a> that generates the 1000&#039;s of spheres that get attached, and performs the benchmarking</li>
<li>Download the Excel report that was built using TimeStamper getReport() function in <a href="/resources/maxscript/For%20Scripters/Time%20Stamper/docs/TimeStamper-report.xls">Excel 2003</a> or <a href="/resources/maxscript/For%20Scripters/Time%20Stamper/docs/TimeStamper-report.xlsx">Excel 2007</a>
</li>
</ul>
<!-- END .entry-content -->
</div>
<!-- FILE davestewart/content-meta.php -->
<!-- BEGIN .entry-meta-footer-->
<div class="entry-meta-footer">
	<!--
    <span class="comment-count">Comments: <span>Comments Off<span class="screen-reader-text"> on Time Stamper &#8211; Meshops.attach() Case Study</span></span></span>
    <span class="author">Posted by: <a href="/author/admin/" title="Posts by Dave Stewart" rel="author">Dave Stewart</a></span>
	-->




	<div class="entry-categories">Categories: </div>
    <div class="entry-tags"></div>
	<div class="published">Date: <span style="font-weight:normal">May 2008</span>
</div>

<!-- END .entry-meta-footer-->
</div>

                                <!-- END .hentry-->
				</div>


<!-- BEGIN #comments -->
<div id="comments">

		<p class="nocomments">Comments are closed.</p>


<!-- END #comments -->
</div>
				<!-- BEGIN .navigation .single-page-navigation -->
				<div class="navigation single-page-navigation">
					<div class="nav-previous">&larr; <a href="/extensions/3dsmax/3dsmax-animation/transform-presets/" rel="prev">Transform Presets</a>
</div>
					<div class="nav-next">
<a href="/extensions/3dsmax/3dsmax-dev-tools/list-struct/" rel="next">&#034;List&#034; struct</a> &rarr;</div>
				<!-- END .navigation .single-page-navigation -->
				</div>

							<!-- END #primary .hfeed-->
			</div>


    		<!-- BEGIN #sidebar .aside-->
		<div id="sidebar" class="aside">

		<div id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"></div></div>
		<!-- END #sidebar .aside-->
		</div>


<!-- FILE davestewart/footer.php -->

        		<!-- END #content -->
		</div>


		<!-- BEGIN #footer -->
		<div id="footer">

		    <!-- BEGIN .footer-inner -->
		    <div class="footer-inner">


		        <!-- BEGIN .footer-col-1 -->
<div class="footer-col-1">

    <div id="ds_links-2" class="widget ds_links">
<h3 class="widget-title">Current site</h3>
<ul><li><a href="https://davestewart.co.uk/">davestewart.co.uk</a></li></ul>
</div>
<!-- END .footer-col-1 -->
</div>

<!-- BEGIN .footer-col-2 -->
<div class="footer-col-2">

    <div id="ds_links-4" class="widget ds_links">
<h3 class="widget-title">Browse Projects</h3>
<ul>
<li><a href="/posts-by-category/">By Category</a></li>
<li><a href="/posts-by-date/">By Date</a></li>
<li>
<a href="/posts-by-tag/">By Tag</a>  </li>
</ul>
</div>
<!-- END .footer-col-2 -->
</div>

<!-- BEGIN .footer-col-3 -->
<div class="footer-col-3">

    <div id="ds_links-3" class="widget ds_links">
<h3 class="widget-title">More Info</h3>
<ul>
<li><a href="https://twitter.com/dave_stewart">Contact</a></li>
<li><a href="/about/">About</a></li>
</ul>
</div>
<!-- END .footer-col-3 -->
</div>

		    <!-- END .footer-inner -->
		    </div>

		    <div class="footer-lower">
		        <div class="footer-inner">
		            <p class="copyright">&copy; Copyright 2015 </p>

		        </div>
		    </div>

		<!-- END #footer -->
		</div>

		<a href="#" id="back-to-top"></a>



	<!-- Theme Hook -->
	<script type="text/javascript">
/* <![CDATA[ */
var zilla = {"ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php","nonce":"61b4b80d02","loading":"Loading..."};
/* ]]> */
</script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.custom.js?ver=1.0"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/comment-reply.min.js?ver=4.9.18"></script>
<script type="text/javascript" src="/wordpress/wp-content/plugins/wp-jquery-lightbox/jquery.touchwipe.min.js?ver=1.4.6"></script>
<script type="text/javascript">
/* <![CDATA[ */
var JQLBSettings = {"showTitle":"1","showCaption":"1","showNumbers":"1","fitToScreen":"0","resizeSpeed":"400","showDownload":"0","navbarOnTop":"0","marginSize":"0","slideshowSpeed":"4000","prevLinkTitle":"previous image","nextLinkTitle":"next image","closeTitle":"close image gallery","image":"Image ","of":" of ","download":"Download","pause":"(pause slideshow)","play":"(play slideshow)"};
/* ]]> */
</script>
<script type="text/javascript" src="/wordpress/wp-content/plugins/wp-jquery-lightbox/jquery.lightbox.min.js?ver=1.4.6"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/jquery/jquery.color.min.js?ver=2.1.1"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/wp-embed.min.js?ver=4.9.18"></script>

	<!-- Ran 34 queries 1.11 seconds -->
<!-- END body-->
</body>
<!-- END html-->
</html>
