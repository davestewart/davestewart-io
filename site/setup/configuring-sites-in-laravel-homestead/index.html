<!DOCTYPE html>
<!-- BEGIN html --><html lang="en-US">
<!-- A ThemeZilla design (http://www.themezilla.com) - Proudly powered by WordPress (http://wordpress.org) -->

<!-- BEGIN head -->
<head>

	<!-- Meta Tags -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="generator" content="Hoarder 1.1.1">
<meta name="generator" content="ZillaFramework 1.0.2.5">
<meta name="description" content="A rough guide to setting up new sites in Laravel&#039;s Homestead, mainly so I don&#039;t forget :)">

	<!-- Title -->
	<title>Configuring sites in Laravel Homestead | Dave Stewart IO</title>

	<!-- RSS & Pingbacks -->
	<link rel="alternate" type="application/rss+xml" title="Dave Stewart IO RSS Feed" href="/feed/">
	<link rel="pingback" href="/wordpress/xmlrpc.php">

	<link rel="dns-prefetch" href="//s.w.org">
<link rel="stylesheet" id="hoarder-style-css" href="/wordpress/wp-content/themes/davestewart/style.css?ver=1.1.1" type="text/css" media="all">
<link rel="stylesheet" id="jquery.lightbox.min.css-css" href="/wordpress/wp-content/plugins/wp-jquery-lightbox/styles/lightbox.min.css?ver=1.4.6" type="text/css" media="all">
<script type="text/javascript" src="/wordpress/wp-includes/js/jquery/jquery.js?ver=1.12.4"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/superfish.js?ver=1.4.8"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/supersubs.js?ver=0.2"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.flexslider-min.js?ver=2.0"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.jplayer.min.js?ver=2.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.imagesloaded.min.js?ver=2.0.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.isotope.min.js?ver=1.5.19"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.fitvids.js?ver=1.0"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/includes/js/twitter.js?ver=4.9.18"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/vendor/jquery/jquery.sticky.js?ver=2.0.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/vendor/jquery/jquery.cookie.js?ver=4.9.18"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/assets/js/zilla-media.js?ver=2.0.1"></script>
<script type="text/javascript" src="/wordpress/wp-content/themes/davestewart/assets/js/scripts.js?ver=2.0.1"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/wordpress/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wordpress/wp-includes/wlwmanifest.xml">
<link rel="canonical" href="/setup/configuring-sites-in-laravel-homestead/">
<link rel="shortlink" href="/?p=1054">
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fsetup%2Fconfiguring-sites-in-laravel-homestead%2F">
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fsetup%2Fconfiguring-sites-in-laravel-homestead%2F&#038;format=xml">

<style type="text/css">.wp-editor-container{
		border:1px solid #DDD;
		margin-bottom:10px;
	}</style>

<!-- END head -->
</head>

<!-- BEGIN body -->
<body class="post-template-default single single-post postid-1054 single-format-standard no-js unknown post-configuring-sites-in-laravel-homestead zilla layout-2cr">

	    		<!-- BEGIN #header -->
		<div id="header">

		    <!-- BEGIN .header-inner -->
		    <div class="header-inner">

    			<!-- BEGIN #logo -->
    			<div id="logo">
    				<a href="/">Dave Stewart</a> <span>|</span> <a href="http://davestewart.co.uk/" title="Go to davestewart.co.uk">io</a>
    				<p id="tagline">Research » Tooling » Open Sorcery</p>
    			<!-- END #logo -->
    			</div>


	        <!-- END .header-inner -->
	        </div>

		<!-- END #header-->
		</div>

		<!-- BEGIN .main-navigation -->
		<div class="main-navigation">

		        		<!-- BEGIN #primary-nav -->
    		<div id="primary-nav">
    		    <ul id="primary-menu" class="menu">
<li id="menu-item-373" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-373"><a href="/">Home</a></li>
<li id="menu-item-369" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-369"><a href="/category/frameworks/">Frameworks</a></li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-368"><a href="/category/tools/">Tools</a></li>
<li id="menu-item-887" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-887"><a href="/all/plugins/">Plugins</a></li>
<li id="menu-item-888" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-888"><a href="/all/extensions/">Extensions</a></li>
<li id="menu-item-1064" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1064"><a href="/category/setup/">Setup</a></li>
<li id="menu-item-977" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-977"><a href="/posts-by-category/">Everything</a></li>
<li id="menu-item-1006" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1006"><a href="/about/">About</a></li>
</ul>
    		    <!-- BEGIN #searchform-->
<form method="get" id="searchform" action="/">
	<fieldset>
		<input type="text" name="s" id="s">
	</fieldset>
<!-- END #searchform-->
</form>    		<!-- END #primary-nav -->
    		</div>

		<!-- END .main-navigation -->
		</div>

		<!-- BEGIN #content -->
		<div id="content" class="clearfix">




<!-- FILE davestewart/single.php -->

			<!-- BEGIN #primary .hfeed-->
			<div id="primary" class="hfeed">

								<!-- BEGIN .hentry -->
				<div class="post-1054 post type-post status-publish format-standard hentry category-setup tag-laravel" id="post-1054">

    				<!-- FILE davestewart/content.php -->
<div class="post-thumb">


</div>

    <h1 class="entry-title">Configuring sites in Laravel Homestead</h1>
	<div class="entry-meta-header">
			</div>



<!-- BEGIN .entry-content -->
<div class="entry-content">

	<p>This post is mainly a reminder on how to do this, as I don&#039;t use Laravel frequently-enough for it to become second nature.</p>
<p>The full setup instructions for setting up Homestead are at <a href="https://laravel.com/docs/5.2/homestead">laravel.com/docs/5.2/homestead</a>, so complete them whilst referring here.</p>
<p><strong>Some other notes:</strong></p>
<ul>
<li>I&#039;ll use a hypothetical site &#034;mysite.dev&#034; to give some context to the steps</li>
<li>I will place the files in the VM in &#034;sites/&#034; and not &#034;Code/&#034;, which frankly, is a <em>silly</em> default</li>
<li>There is a mixture of Windows and Mac info in this post, but I don&#039;t specifically refer to it; you should be able to figure it out</li>
<li>You will need to have some basic knowledge of things such as SSH, and the setup required for your OS to make that happen</li>
</ul>
<h3>1 &#8211; Add your new site to the Homestead.yaml file</h3>
<p>This is the core information needed to set up the VM so that your virtual site will run from your physical files.</p>
<p>It&#039;s also the bit that most people (myself included) get wrong when setting up the VM for the first time, or coming back to it after a break because it looks obvious &#8211; but there are subtle nuances with the folder mappings that can be easy to get wrong &#8211; <strong>so make sure you properly read the following and understand it before continuing!</strong></p>
<p>It essentially covers mappings between:</p>
<ul>
<li>The physical folder location of your files</li>
<li>The virtual folder copy location of your files</li>
<li>The domain / URL of the site</li>
</ul>
<p>The relationships are easier-visualised with a diagram:</p>
<p><a href="/wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping.png" rel="lightbox[1054]"><img class="alignnone size-large wp-image-1071" src="/wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping-900x303.png" alt="Vagrant config to folder mapping" width="580" height="195" srcset="/wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping-900x303.png 900w, /wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping-260x88.png 260w, /wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping-580x195.png 580w, /wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping-768x259.png 768w, /wordpress/wp-content/uploads/setup/configuring-sites-in-laravel-homestead/vagrant-mapping.png 1000w" sizes="(max-width: 580px) 100vw, 580px"></a></p>
<p>The vagrant file has two root nodes called <strong>folders</strong> and <strong>sites</strong> that you&#039;ll use to make your physical files available to the VM and the browser.</p>
<p>Each site will require <strong>two sets of mappings</strong> in the yaml file:</p>
<pre><code style="color: inherit;">folders:
    - map: (1) PROJECT     - the physical location of your project's website files on your computer's hard disk
       to: (2) SITE        - the virtual location inside the virtual machine that will mirror these files
                             Typically, this goes as follows: VAGRANT_FOLDER/SITE_FOLDER/PROJECT_DOMAIN (3)
                             This is also the folder you will SSH into and navigate around, seeing a verbatim copy of your project folder's (1) files

sites:
    - map: (3) DOMAIN      - the URL you will access your site on, and the identifier Vagrant will use to provision your site
       to: (4) PUBLIC      - the public folder of the site folder (2) inside the virtual machine</code></pre>
<p>Edit the <code style="color: #dd1144;">%USERPROFILE%/.homestead/Homestead.yaml</code> file and enter the correct values for your site, making sure not to take anything for granted and stick in the wrong values by mistake:</p>
<pre><code style="color: inherit;">folders:
    - map: C:/Projects/My Site/mysite.dev
      to: /home/vagrant/sites/mysite.dev

sites:
    - map: mysite.dev
      to: /home/vagrant/sites/mysite.dev/public
</code></pre>
<p>Again: note that I&#039;m calling the sites folder &#034;/sites/&#034; whereas the default Homestead installation will refer to it as &#034;/Code/&#034;. Vagrant / Homestead doesn&#039;t care what you call it, as long as it can map a URL &gt; VM folder &gt; physical folder.</p>
<p>Also, note that in theory you could get away with a single folder mapping if you symlink each of your physical sites to a central folder, then map only that folder:</p>
<pre><code style="color: inherit;">folders:
    - map: C:/Sites/
      to: /home/vagrant/sites/</code></pre>
<h3 id="2-did-you-provision-the-site">2 &#8211; &#034;Provision&#034; the site</h3>
<p>This is a slightly esoteric term which results in the creation of the configuration files nginx will use to run the site.</p>
<p>This is done using the command line, from the &#034;Homestead&#034; directory, which if you followed the Laravel guide is in your User folder:</p>
<pre><code style="color: inherit;">cd ~/Homestead
vagrant up --provision
</code></pre>
<p>Once the VM is up, from the same folder, SSH into it:</p>
<pre>vagrant ssh</pre>
<p>The newly-created configuration files can be found inside the VM (the info is pulled from your Homestead.yaml file you just edited) at:</p>
<pre><code style="color: inherit;">/etc/nginx/sites-available/mysite.dev
</code></pre>
<p>Use <code style="color: #dd1144;">nano</code> to view the contents:</p>
<pre><code style="color: inherit;">cd /etc/nginx/sites-available
sudo nano mysite.dev</code></pre>
<p>There is also a <strong>sites-enabled/</strong> folder, which just contains symbolic links to the <strong>sites-available/</strong> folder, for all enabled sites. Editing any files in here will effectively edit the original files.</p>
<p>Without these files existing, your site won&#039;t load. If there is an error, or badly-referenced path in here, nginx won&#039;t start. More (Mac-flavoured info) here: <a href="http://laravel.com/docs/master/homestead">laravel.com/docs/master/homestead</a></p>
<p>You can get back to the folder your site is hosted in (#2 in the config above) as follows:</p>
<pre><code style="color: inherit;">cd /home/vagrant/sites/mysite.dev
</code></pre>
<h3>3 &#8211; Configure your hosts file</h3>
<p>To run the site in the browser using its domain, you have to map the the domain to the IP of Homestead.</p>
<p>Edit your hosts file&#8230;</p>
<pre>C:\Windows\System32\drivers\etc\hosts</pre>
<p>&#8230; and add the project:</p>
<pre>192.168.10.10 mysite.dev</pre>
<p>At this point, test the site in the browser and it should run:</p>
<pre><code style="color: inherit;">http://mysite.dev:8000</code></pre>
<p>If not, for example you&#039;ve moved the site files to a new location or such like&#8230;</p>
<h3>4 &#8211; Make sure nginx is running</h3>
<p>Nginx is the web server inside the VM that serves your site. If it&#039;s not working (perhaps due to a badly-configured config file) your site won&#039;t load, or nginx won&#039;t even start.</p>
<p>I&#039;ve only found this out through trial and error and asking questions on the laravel Slack channel (which I recommend everyone join to get really high-quality help).</p>
<p>In your VM, try restarting nginx by typing:</p>
<pre><code style="color: inherit;">nginx -s restart
</code></pre>
<p>If that fails, test the configuration using:</p>
<pre><code style="color: inherit;">nginx -t
</code></pre>
<p>Check any errors that are thrown (they are quite descriptive, and will tell you the file and line number the error is on &#8211; which could be wrong paths, accidentally-typed characters, etc) and fix them if needs be, then restart nginx using:</p>
<pre><code style="color: inherit;">nginx -s start  #may just be nginx, I can't remember!
</code></pre>
<p>More info here: <a href="https://www.nginx.com/resources/wiki/start/topics/tutorials/commandline/">nginx.com/resources/wiki/start/topics/tutorials/commandline/</a></p>
<h3 id="4-is-your-ssh-console-setup-good-enough">5 &#8211; Make sure your (Windows) SSH console setup good enough</h3>
<p>Lastly, the SSH experience on Windows is SHIT. Unless you have your own setup sorted, I recommend you check out my blog post on getting a setup that works.</p>
<p>You can find it here:</p>
<ul>
<li><a href="/blog/fix-windows-broken-ssh-console/">davestewart.io/blog/fix-windows-broken-ssh-console/</a></li>
</ul>
<p>&nbsp;</p>
<p>That&#039;s it!</p>
<p>&nbsp;</p>
<!-- END .entry-content -->
</div>
<!-- FILE davestewart/content-meta.php -->
<!-- BEGIN .entry-meta-footer-->
<div class="entry-meta-footer">
	<!--
    <span class="comment-count">Comments: <span>Comments Off<span class="screen-reader-text"> on Configuring sites in Laravel Homestead</span></span></span>
    <span class="author">Posted by: <a href="/author/admin/" title="Posts by Dave Stewart" rel="author">Dave Stewart</a></span>
	-->




	<div class="entry-categories">Categories: <a href="/category/setup/" title="View all posts in Setup">Setup</a>
</div>
    <div class="entry-tags">Tags: <a href="/tag/laravel/" rel="tag">Laravel</a>
</div>
	<div class="published">Date: <span style="font-weight:normal">October 2015</span>
</div>

<!-- END .entry-meta-footer-->
</div>

                                <!-- END .hentry-->
				</div>


<!-- BEGIN #comments -->
<div id="comments">

		<p class="nocomments">Comments are closed.</p>


<!-- END #comments -->
</div>
				<!-- BEGIN .navigation .single-page-navigation -->
				<div class="navigation single-page-navigation">
					<div class="nav-previous">&larr; <a href="/setup/fix-windows-broken-ssh-console/" rel="prev">Fix Windows broken SSH console output</a>
</div>
					<div class="nav-next">
<a href="/setup/extract-libraries-to-their-own-repositories/" rel="next">Extract project libraries to their own git repositories</a> &rarr;</div>
				<!-- END .navigation .single-page-navigation -->
				</div>

							<!-- END #primary .hfeed-->
			</div>


    		<!-- BEGIN #sidebar .aside-->
		<div id="sidebar" class="aside">

		<div id="ds_related_categories_widget-2" class="widget DS_Related_Categories_Widget">
<h3 class="widget-title">Related categories</h3>
<ul><li><a href="/category/setup/">Setup <span class="meta">6</span></a></li></ul>
</div>
<div id="ds_related_posts_widget-3" class="widget DS_Related_Posts_Widget">
<h3 class="widget-title">Related Posts in Setup</h3>
<ul>
<li><a href="/setup/wordpress-contact-form-setup/">WordPress contact form setup <span class="meta">2018</span></a></li>
<li><a href="/setup/extract-libraries-to-their-own-repositories/">Extract project libraries to their own git repositories  <span class="meta">2016</span></a></li>
<li><a href="/setup/configuring-sites-in-laravel-homestead/">Configuring sites in Laravel Homestead <span class="meta">2015</span></a></li>
<li><a href="/setup/fix-windows-broken-ssh-console/">Fix Windows broken SSH console output <span class="meta">2015</span></a></li>
<li><a href="/setup/sourceview-indentation-fix/">Github & Bitbucket indentation fix <span class="meta">2015</span></a></li>
<li><a href="/setup/flashdevelop-setup/">FlashDevelop setup <span class="meta">2014</span></a></li>
</ul>
</div>
<div id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"></div></div>
		<!-- END #sidebar .aside-->
		</div>


<!-- FILE davestewart/footer.php -->

        		<!-- END #content -->
		</div>


		<!-- BEGIN #footer -->
		<div id="footer">

		    <!-- BEGIN .footer-inner -->
		    <div class="footer-inner">


		        <!-- BEGIN .footer-col-1 -->
<div class="footer-col-1">

    <div id="ds_links-2" class="widget ds_links">
<h3 class="widget-title">Commercial Portfolio</h3>
<ul><li><a href="http://davestewart.co.uk/">davestewart.co.uk</a></li></ul>
</div>
<!-- END .footer-col-1 -->
</div>

<!-- BEGIN .footer-col-2 -->
<div class="footer-col-2">

    <div id="ds_links-4" class="widget ds_links">
<h3 class="widget-title">Browse Projects</h3>
<ul>
<li><a href="/posts-by-category/">By Category</a></li>
<li><a href="/posts-by-date/">By Date</a></li>
<li>
<a href="/posts-by-tag/">By Tag</a>  </li>
</ul>
</div>
<!-- END .footer-col-2 -->
</div>

<!-- BEGIN .footer-col-3 -->
<div class="footer-col-3">

    <div id="ds_links-3" class="widget ds_links">
<h3 class="widget-title">More Info</h3>
<ul>
<li><a href="https://twitter.com/dave_stewart">Contact</a></li>
<li><a href="/about/">About</a></li>
</ul>
</div>
<!-- END .footer-col-3 -->
</div>

		    <!-- END .footer-inner -->
		    </div>

		    <div class="footer-lower">
		        <div class="footer-inner">
		            <p class="copyright">&copy; Copyright 2022. Powered by <a href="http://wordpress.org/">WordPress</a></p>

		        </div>
		    </div>

		<!-- END #footer -->
		</div>

		<a href="#" id="back-to-top"></a>



	<!-- Theme Hook -->
	<script type="text/javascript">
/* <![CDATA[ */
var zilla = {"ajaxurl":"\/wordpress\/wp-admin\/admin-ajax.php","nonce":"61b4b80d02","loading":"Loading..."};
/* ]]> */
</script>
<script type="text/javascript" src="/wordpress/wp-content/themes/hoarder/js/jquery.custom.js?ver=1.0"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/comment-reply.min.js?ver=4.9.18"></script>
<script type="text/javascript" src="/wordpress/wp-content/plugins/wp-jquery-lightbox/jquery.touchwipe.min.js?ver=1.4.6"></script>
<script type="text/javascript">
/* <![CDATA[ */
var JQLBSettings = {"showTitle":"1","showCaption":"1","showNumbers":"1","fitToScreen":"0","resizeSpeed":"400","showDownload":"0","navbarOnTop":"0","marginSize":"0","slideshowSpeed":"4000","prevLinkTitle":"previous image","nextLinkTitle":"next image","closeTitle":"close image gallery","image":"Image ","of":" of ","download":"Download","pause":"(pause slideshow)","play":"(play slideshow)"};
/* ]]> */
</script>
<script type="text/javascript" src="/wordpress/wp-content/plugins/wp-jquery-lightbox/jquery.lightbox.min.js?ver=1.4.6"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/jquery/jquery.color.min.js?ver=2.1.1"></script>
<script type="text/javascript" src="/wordpress/wp-includes/js/wp-embed.min.js?ver=4.9.18"></script>

	<!-- Ran 38 queries 1.30 seconds -->
<!-- END body-->
</body>
<!-- END html-->
</html>
